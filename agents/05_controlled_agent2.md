[« 制御エージェント](./04_controlled_agent.md) | [Snowflake エージェント »](./06_snowflake_agent.md)

# 概要

学びを活かしさらに前回のエージェント構造を練っていく

- もっともっと**考えさせる**（文章を書かせる）。書かせる順番も気にする
  - 選択する前に毎回反省させる
  - プランを毎回考え直してもらう
  - 要らない出力（違う項目に書かれてしまう内容）を別項目に「逃す」方法も試してみる
- **予算**を与えてみる
  - 「x アクション以内にタスクを完了させてください。現在 y アクションを使用ずみ」
  - 理想はこれでもっと効率できになってくれるし、終わらなそうだったら強制終了もできる
  - API 使用の予算も（例えば検索 API を叩きすぎないように）

# コード

ブランチを切って開発中

https://github.o-in.dwango.co.jp/michael/controlled-llm-agent/tree/v2

# 感想

- **やっぱり言うことを聞かない**
  - モグラ叩きみたいに、一つ解決したと思ったらまた別の方法で不正な返事を返してくる
  - 「必須項目」と言っても無視、「それ以外書かないでください」と言っても書いてくる
- 予算があるとはいえ、効率的になったわけでもない
  - 終了する保証があるだけマシだけど、予算ギリギリになってもあまり動きを変える様子はない
- 変なプラン、脱線はやっぱり避けられないしそうなったら回復できない
  - 毎回プランを考え直させることで、たまに要らないステップを排除してくれるが、以前からやりがちな脱線はそのまま

# 余談

jinja2 でプロンプトを書いたらめっちゃ楽＋便利＋綺麗
